"use strict";(globalThis.webpackChunkbifromq=globalThis.webpackChunkbifromq||[]).push([[6813],{33832(e,i,n){n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"spi/intro","title":"SPI Overview","description":"Service Provider Interfaces (SPIs) are extension points that let you customize BifroMQ\u2019s own runtime behavior. They share the same process and execution context as BifroMQ, and are intended for shaping core behaviors rather than integrating external systems.","source":"@site/docs/spi/intro.md","sourceDirName":"spi","slug":"/spi/intro","permalink":"/docs/spi/intro","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/bifromq-sites/tree/master/docs/spi/intro.md","tags":[],"version":"current","sidebarPosition":0,"frontMatter":{"id":"intro","title":"SPI Overview","sidebar_position":0},"sidebar":"tutorialSidebar","previous":{"title":"Plugin Practice and Notice","permalink":"/docs/plugin/plugin_practice"},"next":{"title":"Admin Guide Overview","permalink":"/docs/admin_guide/overview"}}');var t=n(62615),r=n(35756);const o={id:"intro",title:"SPI Overview",sidebar_position:0},a=void 0,l={},c=[{value:"When to use SPI vs. Plugin",id:"when-to-use-spi-vs-plugin",level:2},{value:"SPI Development Tips",id:"spi-development-tips",level:2},{value:"Available SPIs",id:"available-spis",level:2}];function d(e){const i={admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.p,{children:"Service Provider Interfaces (SPIs) are extension points that let you customize BifroMQ\u2019s own runtime behavior. They share the same process and execution context as BifroMQ, and are intended for shaping core behaviors rather than integrating external systems."}),"\n",(0,t.jsx)(i.admonition,{title:"Important",type:"note",children:(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"SPIs run inside BifroMQ\u2019s process and share its execution context; a deep understanding of internal workflows is required to avoid stability and performance regressions."}),"\n",(0,t.jsxs)(i.li,{children:["ABI compatibility is ",(0,t.jsx)(i.strong,{children:"not guaranteed across releases"}),", and these interfaces are ",(0,t.jsx)(i.strong,{children:"not published to Maven"}),". Keep your SPI implementation version-aligned with the BifroMQ runtime you deploy."]}),"\n",(0,t.jsx)(i.li,{children:"SPIs may change or new ones may appear as the project evolves; verify compatibility before upgrading."}),"\n"]})}),"\n",(0,t.jsx)(i.h2,{id:"when-to-use-spi-vs-plugin",children:"When to use SPI vs. Plugin"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"SPI"}),": Extend/Customize BifroMQ itself (e.g., define custom MQTT message UserProperties or add workload-specific balancing strategies) via Java\u2019s SPI mechanism. Runs in-process and shares BifroMQ\u2019s context."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Plugin"}),": Integrate BifroMQ with external systems (e.g., call an external authentication/authorization service). Plugins run in their own ClassLoader context and are relatively isolated."]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"spi-development-tips",children:"SPI Development Tips"}),"\n",(0,t.jsx)(i.p,{children:"Consult the official Java SPI documentation to understand how discovery and registration work; the following tips highlight BifroMQ-specific considerations:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Fetch the BifroMQ source for the exact runtime version you will deploy; SPI interfaces are not published to Maven Central."}),"\n",(0,t.jsx)(i.li,{children:"Keep your SPI project and the BifroMQ source in a single IDE workspace so you can reference the SPI modules directly without relying on published artifacts."}),"\n",(0,t.jsx)(i.li,{children:"Some SPIs only use the first discovered implementation\u2014deploy a single implementation for those to avoid unexpected behavior. Others can be selected explicitly via configuration, which avoids conflicts."}),"\n",(0,t.jsx)(i.li,{children:"Run and debug with the broker in that workspace (same version), adding logs/metrics to validate behavior."}),"\n",(0,t.jsx)(i.li,{children:"Rebuild and retest whenever you upgrade BifroMQ, since interfaces may change across releases."}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"available-spis",children:"Available SPIs"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"base-env-provider-spi"}),": Provide customized thread environment/context."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"base-kv-local-engine-spi"}),": Customize the local KV engine used by base-kv."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"base-kv-split-hinter-spi"}),": Influence KV partitioning/splitting strategies."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"base-kv-store-balancer-spi"}),": Introduce custom balancing strategies."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"bifromq-dist-worker-spi"}),": Introduce custom balancers to dist worker cluster."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"bifromq-inbox-store-spi"}),": Introduce custom balancers to inbox store cluster."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"bifromq-retain-store-spi"}),": Introduce custom balancers to retain store cluster."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"bifromq-mqtt-server-spi"}),": Extend MQTT server behaviors (e.g., customized user properties hooks)."]}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},35756(e,i,n){n.d(i,{R:()=>o,x:()=>a});var s=n(59471);const t={},r=s.createContext(t);function o(e){const i=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),s.createElement(r.Provider,{value:i},e.children)}}}]);