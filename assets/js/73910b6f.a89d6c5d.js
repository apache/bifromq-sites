"use strict";(globalThis.webpackChunkbifromq=globalThis.webpackChunkbifromq||[]).push([[7801],{45739:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>a});var s=n(96363);const r={},o=s.createContext(r);function i(e){const t=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(o.Provider,{value:t},e.children)}},70403:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"cluster/standardcluster","title":"Deploy StandardCluster","description":"Prerequisites","source":"@site/versioned_docs/version-3.1.x/04_cluster/1_standardcluster.md","sourceDirName":"04_cluster","slug":"/cluster/standardcluster","permalink":"/docs/3.1.x/cluster/standardcluster","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/bifromq-sites/tree/master/versioned_docs/version-3.1.x/04_cluster/1_standardcluster.md","tags":[],"version":"3.1.x","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Deploy StandardCluster"},"sidebar":"tutorialSidebar","previous":{"title":"BifroMQ Cluster Overview","permalink":"/docs/3.1.x/cluster/intro"},"next":{"title":"High Availability","permalink":"/docs/3.1.x/cluster/high_availability"}}');var r=n(47259),o=n(45739);const i={sidebar_position:1,title:"Deploy StandardCluster"},a=void 0,l={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Installation Steps",id:"installation-steps",level:2},{value:"Configurations",id:"configurations",level:3},{value:"Setting Seed Nodes",id:"setting-seed-nodes",level:3},{value:"Setup Bootstrap Node",id:"setup-bootstrap-node",level:3},{value:"Setup Non-Bootstrap Nodes",id:"setup-non-bootstrap-nodes",level:3},{value:"Cluster Status Check",id:"cluster-status-check",level:3}];function c(e){const t={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsx)(t.li,{children:"Ensure you have JDK 17 or higher installed."}),"\n",(0,r.jsxs)(t.li,{children:["Download the latest BifroMQ ",(0,r.jsx)(t.a,{href:"https://github.com/bifromqio/bifromq/releases",children:"release"}),"."]}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"installation-steps",children:"Installation Steps"}),"\n",(0,r.jsxs)(t.p,{children:["This section illustrates the deployment process for a 3-node cluster. Similar to ",(0,r.jsx)(t.a,{href:"/docs/3.1.x/installation/linux",children:"deployment on Linux"}),", you need to extract the downloaded tar file first."]}),"\n",(0,r.jsx)(t.h3,{id:"configurations",children:"Configurations"}),"\n",(0,r.jsx)(t.p,{children:"A configuration file is provided by default with the following settings:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",children:'# The cluster requires exactly one bootstrap node\nbootstrap: true\n\nmqttServerConfig:\n  tcpListener:\n    port: 1883\n\n# BifroMQ Cluster Configuration\nclusterConfig:\n  # Cluster environment, cluster members under same environment can communicate with each other\n  env: "Test"\n  # Host address to bind for inter-member communication. If left blank, a site-local address will be used if available\n  host:\n  # Port for listening to cluster membership-related messages. If left blank, the operating system will automatically choose an available port.\n  # For seed nodes, it is recommended to specify an explicit port number to simplify the cluster building process.\n  port:\n  # Optional DNS domain name used to achieve cluster member address discovery, can be used in K8S environment deployment\n  clusterDomainName:\n  # Comma-separated list of <ADDRESS>:<PORT> for joining the cluster\n  seedEndpoints:\n'})}),"\n",(0,r.jsx)(t.h3,{id:"setting-seed-nodes",children:"Setting Seed Nodes"}),"\n",(0,r.jsxs)(t.p,{children:["Before setting up the cluster, you need to specify seedPoints in a comma-separated format of ",(0,r.jsx)(t.code,{children:"<ADDRESS>:<PORT>"}),", for example:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-yaml",children:"clusterConfig.seedEndpoints: ${NODE1_ADDR}:${PORT},${NODE2_ADDR}:${PORT},${NODE3_ADDR}:${PORT}\n"})}),"\n",(0,r.jsxs)(t.p,{children:["For detailed configuration information, refer to the BifroMQ Configuration ",(0,r.jsx)(t.a,{href:"/docs/3.1.x/admin_guide/configuration/config_file_manual",children:"Documentation"}),"."]}),"\n",(0,r.jsx)(t.h3,{id:"setup-bootstrap-node",children:"Setup Bootstrap Node"}),"\n",(0,r.jsx)(t.p,{children:"Start the bootstrap node using the command:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:"./bin/standalone.sh start\n"})}),"\n",(0,r.jsx)(t.p,{children:"This will create the necessary persistent metadata required for the cluster to function."}),"\n",(0,r.jsx)(t.h3,{id:"setup-non-bootstrap-nodes",children:"Setup Non-Bootstrap Nodes"}),"\n",(0,r.jsxs)(t.p,{children:["For non-bootstrap nodes, the bootstrap configuration must be set to ",(0,r.jsx)(t.strong,{children:(0,r.jsx)(t.code,{children:"false"})})," to prevent them from generating inconsistent metadata.\nRun the script ",(0,r.jsx)(t.code,{children:"./bin/standalone.sh start"})," to start non-boostrap nodes."]}),"\n",(0,r.jsx)(t.h3,{id:"cluster-status-check",children:"Cluster Status Check"}),"\n",(0,r.jsxs)(t.p,{children:["After running the script, the nodes will form a cluster and generate the ",(0,r.jsx)(t.code,{children:"AgentHost joined seedEndpoint: ${seedEndpoints}"})," logs on their respective machines."]}),"\n",(0,r.jsxs)(t.p,{children:["You can also use various system-level ",(0,r.jsx)(t.a,{href:"/docs/3.1.x/admin_guide/observability/metrics/intro",children:"metrics"})," to monitor the cluster's health and performance."]})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}}}]);