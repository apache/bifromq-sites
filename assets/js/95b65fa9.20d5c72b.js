"use strict";(self.webpackChunkbifromq=self.webpackChunkbifromq||[]).push([[6562],{56719:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>a,default:()=>m,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"installation/docker","title":"Docker","description":"Prerequisites","source":"@site/versioned_docs/version-3.1.x/02_installation/1_docker.md","sourceDirName":"02_installation","slug":"/installation/docker","permalink":"/docs/3.1.x/installation/docker","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/bifromq-sites/tree/master/website/versioned_docs/version-3.1.x/02_installation/1_docker.md","tags":[],"version":"3.1.x","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Docker"},"sidebar":"tutorialSidebar","previous":{"title":"Installation Overview","permalink":"/docs/3.1.x/installation/intro"},"next":{"title":"Linux","permalink":"/docs/3.1.x/installation/linux"}}');var o=n(23420),r=n(65404);const s={sidebar_position:1,title:"Docker"},a=void 0,c={},l=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Docker Command",id:"docker-command",level:2},{value:"Memory Constraints",id:"memory-constraints",level:2}];function d(e){const i={a:"a",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:[(0,o.jsx)(i.a,{href:"https://www.docker.com/",children:"Docker"})," is installed."]}),"\n",(0,o.jsx)(i.li,{children:"You have permission to use port 1883, and the port are available. If you do not have permission, please change to the corresponding port."}),"\n"]}),"\n",(0,o.jsx)(i.h2,{id:"docker-command",children:"Docker Command"}),"\n",(0,o.jsxs)(i.p,{children:["Run the following command, which will run BifroMQ within a container as the Linux user ",(0,o.jsx)(i.code,{children:"bifromq"}),"."]}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{children:"docker run -d --name bifromq -p 1883:1883 bifromq/bifromq:latest\n"})}),"\n",(0,o.jsx)(i.h2,{id:"memory-constraints",children:"Memory Constraints"}),"\n",(0,o.jsx)(i.p,{children:"By default, upon BifroMQ process initiation, it dynamically computes the relevant JVM parameters based on the physical memory of the hosting server. However, when launched within a containerized environment, it introspects the host\nmachine's physical memory, potentially causing conflicts with Docker or container-imposed memory constraints, consequently leading to the premature termination of the container."}),"\n",(0,o.jsxs)(i.p,{children:["To circumvent such challenges, it is advisable to proactively delimit the container's memory consumption and convey these limitations to the container runtime via environmental variables. During the startup of BifroMQ, priority is given to\nthe calculation of JVM parameters based on the ",(0,o.jsx)(i.code,{children:"MEM_LIMIT"})," environmental variable. A specific illustration is provided below:"]}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{children:"docker run -d -m 10G -e MEM_LIMIT='10737418240' --name bifromq -p 1883:1883 bifromq/bifromq:latest\n"})}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.em,{children:(0,o.jsx)(i.strong,{children:"Note: The unit of MEM_LIMIT is in bytes."})})}),"\n",(0,o.jsx)(i.p,{children:"Going a step further, it is possible to proactively configure the JVM heap memory and directly transmit it to the container runtime for utilization by BifroMQ. A specific illustration is provided below:"}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{children:"docker run -d -m 10G -e JVM_HEAP_OPTS='-Xms2G -Xmx4G -XX:MetaspaceSize=128m -XX:MaxMetaspaceSize=500m -XX:MaxDirectMemorySize=1G' --name bifromq -p 1883:1883 bifromq/bifromq:latest\n"})})]})}function m(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},65404:(e,i,n)=>{n.d(i,{R:()=>s,x:()=>a});var t=n(36672);const o={},r=t.createContext(o);function s(e){const i=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(r.Provider,{value:i},e.children)}}}]);